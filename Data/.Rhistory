# задаем рабочий каталог
setwd("/Users/artemgruzdev/Documents/Курс/Course_ML/Data")
# загружаем данные
data <- read.csv2("StateFarm_missing.csv",
sep = ";",
na.strings = "")
# выводим первые 5 наблюдений
head(data, 5)
# смотрим типы переменных
str(data)
# выполняем необходимые преобразования
# преобразовываем в числовой вектор
data$Customer.Lifetime.Value <- as.numeric(
levels(data$Customer.Lifetime.Value)[data$Customer.Lifetime.Value])
data$Response <- as.factor(data$Response)
# смотрим типы переменных и данные
str(data)
head(data, 5)
# разбиваем данные на обучающие и тестовые
set.seed(100)
ind <- sample(2, nrow(data),
replace = TRUE,
prob = c(0.7, 0.3))
development <- data[ind == 1, ]
holdout <- data[ind == 2, ]
# смотрим пропуски в обучающей выборке
sapply(development, function(x) sum(is.na(x)))
# смотрим пропуски в тестовой выборке
sapply(holdout, function(x) sum(is.na(x)))
# устанавливаем пакет imputeMissings
# install.packages("imputeMissings")
# загружаем пакет imputeMissings
library(imputeMissings)
library(caret)
